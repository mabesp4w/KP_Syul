import{u as B,r as p,z as f,b as E,j as e,H as D,L as I,a as k}from"./app-DtJ35xiz.js";import{S as T}from"./SelectChain-AmMfXIqx.js";import{M as z,C as $}from"./ConfirmDialog-DwnvgXmc.js";import{B as g}from"./Button-MploRZnw.js";import{S as F}from"./SearchBox-CSScaDuk.js";import{A as U}from"./AdminLayout-BH41KSEt.js";import{o as V,s as S}from"./schemas-DYt2ce8c.js";import"./Badge-bqPMSCrt.js";import"./AOSWrapper-CyGhR2Oq.js";const W=V({prov_id:S().min(1,"Provinsi wajib dipilih"),nm_kab:S().min(1,"Nama kabupaten/kota wajib diisi").max(255,"Nama kabupaten/kota maksimal 255 karakter")});function ae({auth:C,kabKota:t,provinsi:N,filters:d}){const{flash:c}=B().props,[M,w]=p.useState(!1),[L,u]=p.useState(!1),[r,i]=p.useState(null),[m,o]=p.useState(!1);p.useEffect(()=>{c?.success&&f.success(c.success),c?.error&&f.error(c.error)},[c]);const{data:x,setData:b,post:P,processing:h,errors:j,reset:K}=E({prov_id:"",nm_kab:""}),_=(a=null)=>{a?(i(a),b({prov_id:String(a.prov_id),nm_kab:a.nm_kab})):(i(null),b({prov_id:d?.prov_id||"",nm_kab:""})),w(!0)},v=()=>{w(!1),i(null),K()},y=a=>{if(a.preventDefault(),o(!0),!W.safeParse(x).success){o(!1);return}r?k.patch(`/admin/kab-kota/${r.id}`,x,{preserveScroll:!0,onSuccess:()=>{v(),o(!1)},onError:s=>{if(console.error("Update error:",s),s&&Object.keys(s).length>0&&!s.message){const l=Object.values(s)[0];f.error(Array.isArray(l)?l[0]:l)}o(!1)}}):P("/admin/kab-kota",{preserveScroll:!0,onSuccess:()=>{v(),o(!1)},onError:s=>{if(console.error("Create error:",s),s&&Object.keys(s).length>0&&!s.message){const l=Object.values(s)[0];f.error(Array.isArray(l)?l[0]:l)}o(!1)}})},A=a=>{i(a),u(!0)},H=()=>{r&&k.delete(`/admin/kab-kota/${r.id}`,{preserveScroll:!0,onSuccess:()=>{u(!1),i(null)},onError:a=>{console.error("Delete error:",a),u(!1)}})},O=a=>{const n=a.target.value;k.get("/admin/kab-kota",{...d,prov_id:n||null},{preserveState:!0,replace:!0})};return e.jsxs(U,{auth:C,children:[e.jsx(D,{title:"Manajemen Kabupaten/Kota"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center","data-aos":"fade-down",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Manajemen Kabupaten/Kota"}),e.jsx("p",{className:"mt-1 text-base-content/70",children:"Kelola data kabupaten/kota di Indonesia"})]}),e.jsxs(g,{onClick:()=>_(),variant:"primary",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Tambah Kabupaten/Kota"]})]}),e.jsx("div",{className:"card bg-base-100 shadow-sm","data-aos":"fade-up","data-aos-delay":"100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 items-end justify-end gap-4 md:grid-cols-2",children:[e.jsx(F,{placeholder:"Cari kabupaten/kota atau provinsi...",defaultValue:d?.search||"",route:"/admin/kab-kota",routeParams:d,debounceMs:500}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Filter Provinsi"})}),e.jsxs("select",{className:"select-bordered select w-full",value:d?.prov_id||"",onChange:O,children:[e.jsx("option",{value:"",children:"Semua Provinsi"}),N.map(a=>e.jsx("option",{value:a.id,children:a.nm_prov},a.id))]})]})]})})}),e.jsx("div",{className:"card bg-base-100 shadow-sm","data-aos":"fade-up","data-aos-delay":"200",children:e.jsxs("div",{className:"card-body p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Nama Kabupaten/Kota"}),e.jsx("th",{children:"Provinsi"}),e.jsx("th",{className:"text-right",children:"Aksi"})]})}),e.jsx("tbody",{children:t.data.length>0?t.data.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.from+n}),e.jsx("td",{children:e.jsx("div",{className:"font-medium",children:a.nm_kab})}),e.jsx("td",{children:e.jsx("div",{className:"text-sm text-base-content/70",children:a.provinsi?.nm_prov||"-"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>_(a),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Ubah"]}),e.jsxs("button",{className:"btn btn-sm btn-error",onClick:()=>A(a),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus"]})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"py-8 text-center text-base-content/50",children:e.jsx("p",{children:"Tidak ada data kabupaten/kota"})})})})]})}),t.links&&t.links.length>3&&e.jsx("div",{className:"card-body border-t border-base-300",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-sm text-base-content/70",children:["Menampilkan ",t.from," sampai ",t.to," dari ",t.total," data"]}),e.jsx("div",{className:"join",children:t.links.map((a,n)=>e.jsx(I,{href:a.url||"#",className:`btn join-item btn-sm ${a.active?"btn-active":a.url?"":"btn-disabled"}`,dangerouslySetInnerHTML:{__html:a.label}},n))})]})})]})})]}),e.jsx(z,{id:"kab-kota-modal",isOpen:M,onClose:v,title:r?"Ubah Kabupaten/Kota":"Tambah Kabupaten/Kota",size:"md",footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{variant:"ghost",onClick:v,disabled:m||h,children:"Batal"}),e.jsx(g,{variant:"primary",onClick:y,disabled:m||h,loading:m||h,children:r?"Simpan Perubahan":"Tambah"})]}),children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx(T,{levels:[{name:"prov_id",label:"Provinsi",options:N,optionValue:"id",optionLabel:"nm_prov",required:!0,placeholder:"Pilih Provinsi"}],values:x,onChange:(a,n)=>b(a,n),errors:j,disabled:m||h}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text",children:["Nama Kabupaten/Kota ",e.jsx("span",{className:"text-error",children:"*"})]})}),e.jsx("input",{type:"text",className:`input-bordered input w-full ${j.nm_kab?"input-error":""}`,placeholder:"Masukkan nama kabupaten/kota",value:x.nm_kab,onChange:a=>b("nm_kab",a.target.value),disabled:m||h}),j.nm_kab&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:j.nm_kab})})]})]})}),e.jsx($,{isOpen:L,onClose:()=>{u(!1),i(null)},onConfirm:H,title:"Hapus Kabupaten/Kota",message:`Apakah Anda yakin ingin menghapus "${r?.nm_kab}"?`,confirmText:"Hapus",cancelText:"Batal",variant:"error"})]})}export{ae as default};
