import{u as z,r as x,z as k,j as e,H as B,a as h}from"./app-DtJ35xiz.js";import{M as C,C as I}from"./ConfirmDialog-DwnvgXmc.js";import{B as p}from"./Button-MploRZnw.js";import{S as K}from"./SearchBox-CSScaDuk.js";import{A as W}from"./AdminLayout-BH41KSEt.js";import{u as V,o as P,c as U,a as q,d as w}from"./index.esm-BBRPuYfN.js";import"./Badge-bqPMSCrt.js";import"./AOSWrapper-CyGhR2Oq.js";const J=U({nm_fasilitas:w().required("Nama fasilitas wajib diisi").max(255,"Nama fasilitas maksimal 255 karakter"),ket:w().nullable(),kapasitas:w().nullable().test("is-number","Kapasitas harus berupa angka positif",d=>{if(!d||d==="")return!0;const r=parseInt(d,10);return!isNaN(r)&&r>=0}),tersedia:q().default(!0)});function ae({auth:d,fasilitas:r,filters:o}){const{flash:m}=z().props,[M,y]=x.useState(!1),[_,u]=x.useState(!1),[F,j]=x.useState(!1),[a,l]=x.useState(null);x.useEffect(()=>{m?.success&&k.success(m.success),m?.error&&k.error(m.error)},[m]);const{register:b,handleSubmit:L,reset:N,setValue:f,watch:T,formState:{errors:i,isSubmitting:S}}=V({resolver:P(J),defaultValues:{nm_fasilitas:"",ket:"",kapasitas:"",tersedia:!0}}),O=T("tersedia"),g=(s=null)=>{s?(l(s),f("nm_fasilitas",s.nm_fasilitas),f("ket",s.ket||""),f("kapasitas",s.kapasitas?String(s.kapasitas):""),f("tersedia",s.tersedia??!0)):(l(null),N({nm_fasilitas:"",ket:"",kapasitas:"",tersedia:!0})),y(!0)},v=()=>{y(!1),l(null),N({nm_fasilitas:"",ket:"",kapasitas:"",tersedia:!0})},A=s=>{const n={nm_fasilitas:s.nm_fasilitas,ket:s.ket||null,kapasitas:s.kapasitas?parseInt(s.kapasitas,10):null,tersedia:s.tersedia};a?h.patch(`/admin/fasilitas/${a.id}`,n,{preserveScroll:!0,onSuccess:()=>{v()},onError:t=>{if(console.error("Update error:",t),t&&Object.keys(t).length>0&&!t.message){const c=Object.values(t)[0];k.error(Array.isArray(c)?c[0]:c)}}}):h.post("/admin/fasilitas",n,{preserveScroll:!0,onSuccess:()=>{N({nm_fasilitas:"",ket:"",kapasitas:"",tersedia:!0})},onError:t=>{if(console.error("Create error:",t),t&&Object.keys(t).length>0&&!t.message){const c=Object.values(t)[0];k.error(Array.isArray(c)?c[0]:c)}}})},E=s=>{l(s),j(!0)},H=s=>{l(s),u(!0)},$=()=>{a&&h.delete(`/admin/fasilitas/${a.id}`,{preserveScroll:!0,onSuccess:()=>{u(!1),l(null)},onError:s=>{console.error("Delete error:",s),u(!1)}})},D=s=>{const n=s.target.value;h.get("/admin/fasilitas",{...o,tersedia:n||null},{preserveState:!0,replace:!0})};return e.jsxs(W,{auth:d,children:[e.jsx(B,{title:"Manajemen Fasilitas"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center","data-aos":"fade-down",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-base-content",children:"Fasilitas"}),e.jsx("p",{className:"mt-1 text-base-content/70",children:"Kelola data fasilitas program pendidikan"})]}),e.jsxs(p,{onClick:()=>g(),className:"btn-primary",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Tambah Fasilitas"]})]}),e.jsx("div",{className:"card bg-base-100 shadow-sm","data-aos":"fade-up","data-aos-delay":"100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 items-end justify-end gap-4 md:grid-cols-2",children:[e.jsx(K,{placeholder:"Cari fasilitas...",defaultValue:o?.search||"",route:"/admin/fasilitas",routeParams:o,debounceMs:500}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Filter Ketersediaan"})}),e.jsxs("select",{className:"select-bordered select w-full",value:o?.tersedia!==void 0?String(o.tersedia):"",onChange:D,children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"1",children:"Tersedia"}),e.jsx("option",{value:"0",children:"Tidak Tersedia"})]})]})]})})}),e.jsx("div",{className:"card bg-base-100 shadow-sm","data-aos":"fade-up","data-aos-delay":"200",children:e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Nama Fasilitas"}),e.jsx("th",{children:"Keterangan"}),e.jsx("th",{children:"Kapasitas"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:r.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-8 text-center text-base-content/70",children:"Tidak ada data fasilitas"})}):r.data.map((s,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:r.from+n}),e.jsx("td",{children:e.jsx("div",{className:"font-medium",children:s.nm_fasilitas})}),e.jsx("td",{children:s.ket?e.jsx("div",{className:"line-clamp-2 text-sm text-base-content/70",children:s.ket}):e.jsx("span",{className:"text-base-content/50",children:"-"})}),e.jsx("td",{children:s.kapasitas?s.kapasitas.toLocaleString("id-ID"):"-"}),e.jsx("td",{children:s.tersedia?e.jsx("span",{className:"badge badge-success",children:"Tersedia"}):e.jsx("span",{className:"badge badge-error",children:"Tidak Tersedia"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>E(s),title:"Detail",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>g(s),title:"Edit",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{className:"btn text-error btn-ghost btn-sm",onClick:()=>H(s),title:"Hapus",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},s.id))})]})})})}),r.links.length>3&&e.jsx("div",{className:"flex justify-center","data-aos":"fade-up","data-aos-delay":"300",children:e.jsx("div",{className:"join",children:r.links.map((s,n)=>e.jsx("button",{className:`btn join-item ${s.active?"btn-active":""} ${s.url?"":"btn-disabled"}`,onClick:()=>s.url&&h.get(s.url),dangerouslySetInnerHTML:{__html:s.label}},n))})}),e.jsx(C,{isOpen:M,onClose:v,title:a?"Edit Fasilitas":"Tambah Fasilitas",size:"4xl",children:e.jsxs("form",{onSubmit:L(A),className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text",children:["Nama Fasilitas ",e.jsx("span",{className:"text-error",children:"*"})]})}),e.jsx("input",{type:"text",className:`input-bordered input w-full ${i.nm_fasilitas?"input-error":""}`,...b("nm_fasilitas"),placeholder:"Masukkan nama fasilitas"}),i.nm_fasilitas&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:i.nm_fasilitas.message})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Jumlah (Opsional)"})}),e.jsx("input",{type:"text",className:`input-bordered input w-full ${i.kapasitas?"input-error":""}`,...b("kapasitas"),placeholder:"Masukkan kapasitas"}),i.kapasitas&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:i.kapasitas.message})})]}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer",children:[e.jsx("span",{className:"label-text",children:"Status Tersedia"}),e.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:O,...b("tersedia")})]})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Keterangan (Opsional)"})}),e.jsx("textarea",{className:`textarea-bordered textarea w-full ${i.ket?"textarea-error":""}`,...b("ket"),placeholder:"Masukkan keterangan fasilitas",rows:"4"}),i.ket&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:i.ket.message})})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx(p,{type:"button",onClick:v,className:"btn-ghost",children:"Batal"}),e.jsx(p,{type:"submit",className:"btn-primary",disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-sm loading-spinner"}),a?"Menyimpan...":"Menambahkan..."]}):a?"Simpan Perubahan":"Tambah Fasilitas"})]})]})}),e.jsx(C,{isOpen:F,onClose:()=>{j(!1),l(null)},title:"Detail Fasilitas",size:"3xl",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 border-b border-base-300 pb-4",children:[e.jsx("div",{className:"placeholder avatar",children:e.jsx("div",{className:"w-16 rounded-full bg-primary text-primary-content",children:e.jsx("span",{className:"text-2xl",children:a.nm_fasilitas?.charAt(0).toUpperCase()||"F"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:a.nm_fasilitas}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.tersedia?e.jsx("span",{className:"badge badge-success",children:"Tersedia"}):e.jsx("span",{className:"badge badge-error",children:"Tidak Tersedia"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-base-content/70",children:"Kapasitas"}),e.jsx("p",{className:"mt-1",children:a.kapasitas?a.kapasitas.toLocaleString("id-ID"):"-"})]})}),e.jsx("div",{className:"space-y-4",children:a.ket&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-base-content/70",children:"Keterangan"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap",children:a.ket})]})})]}),e.jsxs("div",{className:"modal-action",children:[e.jsxs(p,{type:"button",onClick:()=>{j(!1),g(a)},className:"btn-primary",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Fasilitas"]}),e.jsx(p,{type:"button",onClick:()=>{j(!1),l(null)},className:"btn-ghost",children:"Tutup"})]})]})}),e.jsx(I,{isOpen:_,onClose:()=>{u(!1),l(null)},onConfirm:$,title:"Hapus Fasilitas",message:`Apakah Anda yakin ingin menghapus fasilitas "${a?.nm_fasilitas}"?`})]})]})}export{ae as default};
